<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–π–º–µ—Ä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</title>
    <style>
        /* –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white; min-height: 100vh; padding: 20px; transition: all 0.3s ease;
        }
        body.fullscreen { padding: 0; }
        .container {
            max-width: 800px; margin: 0 auto; background: rgba(0, 0, 0, 0.7);
            border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }
        /* ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... */

        /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ó–ê–ì–†–£–ó–ö–ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò */
        .config-controls {
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            border: 1px dashed #4ecdc4;
        }
        .config-controls h3 {
            color: #4ecdc4;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.1rem;
        }
        .config-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .config-btn {
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .config-btn:hover {
            background: #3a506b;
            transform: translateY(-2px);
        }
        .config-btn.download {
            background: #27ae60;
        }
        .config-btn.download:hover {
            background: #219653;
        }
        .config-btn.reset {
            background: #e74c3c;
        }
        .config-btn.reset:hover {
            background: #c0392b;
        }
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }
        .file-input-wrapper input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        .config-info {
            margin-top: 10px;
            font-size: 0.8rem;
            color: #a3b5cc;
            text-align: center;
        }
        .current-config {
            margin-top: 5px;
            font-size: 0.85rem;
            color: #ffd166;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-radius: 5px;
            text-align: center;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        @media (max-width: 600px) {
            .config-buttons {
                flex-direction: column;
            }
            .config-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="keep-alive-info" id="keepAliveInfo">üîã –≠–∫—Ä–∞–Ω –∞–∫—Ç–∏–≤–µ–Ω</div>
    <div class="container">
        <div class="header">
            <h1>üî• –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ñ–∏—Ä–æ—Å–∂–∏–≥–∞—Ç–µ–ª—å</h1>
            <button class="fullscreen-btn" id="fullscreenBtn" title="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º">‚õ∂</button>
        </div>
        <div class="subtitle">–¢–∞–π–º–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å –≥–æ–ª–æ—Å–æ–≤—ã–º–∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è–º–∏</div>
        <div class="control-panel">
            <div class="control-group">
                <label for="circles">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä—É–≥–æ–≤:</label>
                <select id="circles">
                    <option value="3">3 –∫—Ä—É–≥–∞</option><option value="4">4 –∫—Ä—É–≥–∞</option>
                    <option value="5" selected>5 –∫—Ä—É–≥–æ–≤</option><option value="6">6 –∫—Ä—É–≥–æ–≤</option>
                    <option value="7">7 –∫—Ä—É–≥–æ–≤</option><option value="8">8 –∫—Ä—É–≥–æ–≤</option>
                    <option value="9">9 –∫—Ä—É–≥–æ–≤</option>
                </select>
            </div>
            <button class="action-btn" id="startBtn">‚ñ∂ –°—Ç–∞—Ä—Ç</button>
            <button class="action-btn" id="pauseBtn" disabled>‚è∏ –ü–∞—É–∑–∞</button>
            <button class="action-btn" id="resetBtn">üîÑ –°–±—Ä–æ—Å</button>
            <div class="volume-control">
                <span>üîä</span><input type="range" id="volume" min="0" max="1" step="0.1" value="1">
                <span id="volumeValue">100%</span>
            </div>
        </div>
        
        <!-- –ù–û–í–´–ô –ë–õ–û–ö: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π -->
        <div class="config-controls">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–∞–º–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</h3>
            <div class="config-buttons">
                <div class="file-input-wrapper">
                    <button class="config-btn" id="loadConfigBtn">
                        üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Å
                    </button>
                    <input type="file" id="configFileInput" accept=".json" style="display: none;">
                </div>
                <button class="config-btn download" id="downloadConfigBtn">
                    ‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–º–ø–ª–µ–∫—Å
                </button>
                <button class="config-btn" id="saveConfigBtn">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π
                </button>
                <button class="config-btn reset" id="resetConfigBtn">
                    üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ –±–∞–∑–æ–≤–æ–º—É
                </button>
            </div>
            <div class="config-info">
                –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è JSON-—Ñ–∞–π–ª—ã —Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ç–∞–π–º–µ—Ä–∞
            </div>
            <div class="current-config" id="currentConfigInfo">
                –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: –ë–∞–∑–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å (9 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π)
            </div>
        </div>
        
        <div class="timer-display">
            <div class="time" id="timer">45</div>
            <div class="exercise-info" id="exerciseName">–î–∂–∞–º–ø –¥–∂–µ–∫</div>
            <div class="phase-info" id="phase">–†–∞–±–æ—Ç–∞</div>
            <div class="circle-info" id="circleInfo">–ö—Ä—É–≥: 1/5</div>
            
            <div class="exercise-details">
                <div class="next-exercise" id="nextExercise">
                    –î–∞–ª–µ–µ: <span id="nextExerciseName">–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è</span>
                </div>
                <div class="technique" id="technique">
                    –ü—Ä—ã–∂–∫–∏ —Å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ä–∞–∑–≤–µ–¥–µ–Ω–∏–µ–º —Ä—É–∫ –∏ –Ω–æ–≥. –î–µ—Ä–∂–∏—Ç–µ —Å–ø–∏–Ω—É –ø—Ä—è–º–æ–π.
                </div>
                <button class="hint-toggle" id="hintToggle">–û–∑–≤—É—á–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É</button>
            </div>
        </div>
        <div class="status" id="status">–ì–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</div>
        <div class="workout-list">
            <h3>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤ –∫—Ä—É–≥–µ:</h3>
            <div id="exercisesList"></div>
        </div>
    </div>

    <script>
        // ================= –ë–ê–ó–û–í–´–ô –ö–û–ú–ü–õ–ï–ö–° –£–ü–†–ê–ñ–ù–ï–ù–ò–ô =================
        const defaultExercises = [
            {
                name: "–î–∂–∞–º–ø –¥–∂–µ–∫",
                technique: "–ò—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ: –Ω–æ–≥–∏ –≤–º–µ—Å—Ç–µ, —Ä—É–∫–∏ –≤–¥–æ–ª—å —Ç–µ–ª–∞. –ü—Ä—ã–∂–∫–æ–º —Ä–∞—Å—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–≥–∏ —à–∏—Ä–µ –ø–ª–µ—á, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–¥–Ω–∏–º–∞—è —Ä—É–∫–∏ —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–æ–Ω—ã –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π. –ü—Ä—ã–∂–∫–æ–º –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ. –î–µ—Ä–∂–∏—Ç–µ —Å–ø–∏–Ω—É –ø—Ä—è–º–æ–π, –ø—Ä–∏–∑–µ–º–ª—è–π—Ç–µ—Å—å –º—è–≥–∫–æ –Ω–∞ –Ω–æ—Å–∫–∏."
            },
            {
                name: "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è (–∏–ª–∏ –ê–≤—Å—Ç—Ä–∞–ª–∏–π—Å–∫–∏–µ)",
                technique: "–î–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö: –≤–æ–∑—å–º–∏—Ç–µ—Å—å –∑–∞ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω—É —Ö–≤–∞—Ç–æ–º —à–∏—Ä–µ –ø–ª–µ—á. –ù–∞ –≤—ã–¥–æ—Ö–µ –ø–æ–¥—Ç—è–Ω–∏—Ç–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–¥–±–æ—Ä–æ–¥–æ–∫ –æ–∫–∞–∑–∞–ª—Å—è –Ω–∞–¥ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–æ–π. –ù–∞ –≤–¥–æ—Ö–µ –º–µ–¥–ª–µ–Ω–Ω–æ –æ–ø—É—Å—Ç–∏—Ç–µ—Å—å. –î–ª—è –∞–≤—Å—Ç—Ä–∞–ª–∏–π—Å–∫–∏—Ö: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∏–∑–∫—É—é –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω—É, —Ç–µ–ª–æ –ø–æ–¥ —É–≥–ª–æ–º, –ø–æ–¥—Ç—è–≥–∏–≤–∞–π—Ç–µ –≥—Ä—É–¥—å –∫ –ø–µ—Ä–µ–∫–ª–∞–¥–∏–Ω–µ."
            },
            {
                name: "–ë—ë—Ä–ø–∏",
                technique: "1. –ò–∑ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Å—Ç–æ—è –ø—Ä–∏—Å—è–¥—å—Ç–µ, —É–ø—Ä–∏—Ç–µ—Å—å –ª–∞–¥–æ–Ω—è–º–∏ –≤ –ø–æ–ª. 2. –ü—Ä—ã–∂–∫–æ–º –æ—Ç–±—Ä–æ—Å—å—Ç–µ –Ω–æ–≥–∏ –Ω–∞–∑–∞–¥ –≤ –ø–ª–∞–Ω–∫—É. 3. –°–¥–µ–ª–∞–π—Ç–µ –æ—Ç–∂–∏–º–∞–Ω–∏–µ (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏). 4. –ü—Ä—ã–∂–∫–æ–º –ø–æ–¥—Ç—è–Ω–∏—Ç–µ –Ω–æ–≥–∏ –∫ —Ä—É–∫–∞–º. 5. –í—ã–ø—Ä—ã–≥–Ω–∏—Ç–µ –≤–≤–µ—Ä—Ö —Å —Ö–ª–æ–ø–∫–æ–º –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π."
            },
            {
                name: "–û—Ç–∂–∏–º–∞–Ω–∏—è",
                technique: "–ü—Ä–∏–º–∏—Ç–µ —É–ø–æ—Ä –ª—ë–∂–∞, —Ç–µ–ª–æ –æ–±—Ä–∞–∑—É–µ—Ç –ø—Ä—è–º—É—é –ª–∏–Ω–∏—é –æ—Ç –≥–æ–ª–æ–≤—ã –¥–æ –ø—è—Ç. –õ–∞–¥–æ–Ω–∏ –ø–æ–¥ –ø–ª–µ—á–∞–º–∏. –ù–∞ –≤–¥–æ—Ö–µ —Å–æ–≥–Ω–∏—Ç–µ –ª–æ–∫—Ç–∏, –æ–ø—É—Å–∫–∞—è —Ç–µ–ª–æ –ø–æ—á—Ç–∏ –¥–æ –ø–æ–ª–∞. –õ–æ–∫—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞–∑–∞–¥ –ø–æ–¥ —É–≥–ª–æ–º 45¬∞. –ù–∞ –≤—ã–¥–æ—Ö–µ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ."
            },
            {
                name: "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å –≤—ã–ø—Ä—ã–≥–∏–≤–∞–Ω–∏–µ–º",
                technique: "–ü–æ—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–≥–∏ –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≥–ª—É–±–æ–∫–∏–π –ø—Ä–∏—Å–µ–¥, –æ—Ç–≤–æ–¥—è —Ç–∞–∑ –Ω–∞–∑–∞–¥, –∫–∞–∫ –±—É–¥—Ç–æ —Å–∞–¥–∏—Ç–µ—Å—å –Ω–∞ —Å—Ç—É–ª. –†—É–∫–∏ –¥–ª—è –±–∞–ª–∞–Ω—Å–∞. –ò–∑ –Ω–∏–∂–Ω–µ–π —Ç–æ—á–∫–∏ –º–æ—â–Ω–æ –≤—ã–ø—Ä—ã–≥–Ω–∏—Ç–µ –≤–≤–µ—Ä—Ö, –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø—Ä—è–º–ª—è—è –Ω–æ–≥–∏. –ú—è–≥–∫–æ –ø—Ä–∏–∑–µ–º–ª–∏—Ç–µ—Å—å –∏ —Å—Ä–∞–∑—É —É—Ö–æ–¥–∏—Ç–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏—Å–µ–¥."
            },
            {
                name: "–í–µ–ª–æ—Å–∏–ø–µ–¥",
                technique: "–õ—ë–∂–∞ –Ω–∞ —Å–ø–∏–Ω–µ, –ø–æ—è—Å–Ω–∏—Ü–∞ –ø—Ä–∏–∂–∞—Ç–∞ –∫ –ø–æ–ª—É, —Ä—É–∫–∏ –∑–∞ –≥–æ–ª–æ–≤–æ–π. –ü–æ–¥–Ω–∏–º–∏—Ç–µ –ª–æ–ø–∞—Ç–∫–∏. –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–¥—Ç—è–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–µ –∫–æ–ª–µ–Ω–æ –∫ –≥—Ä—É–¥–∏ –∏ –ø–æ—Ç—è–Ω–∏—Ç–µ—Å—å –∫ –Ω–µ–º—É –ª–µ–≤—ã–º –ª–æ–∫—Ç–µ–º, –≤—ã–ø—Ä—è–º–ª—è—è –ª–µ–≤—É—é –Ω–æ–≥—É. –°–º–µ–Ω–∏—Ç–µ —Å—Ç–æ—Ä–æ–Ω—É. –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –ø–ª–∞–≤–Ω–æ, –±–µ–∑ —Ä—ã–≤–∫–æ–≤, —á—É–≤—Å—Ç–≤—É–π—Ç–µ —Ä–∞–±–æ—Ç—É –ø—Ä–µ—Å—Å–∞."
            },
            {
                name: "–ê–ª—å–ø–∏–Ω–∏—Å—Ç Cross-body",
                technique: "–ü—Ä–∏–º–∏—Ç–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–ª–∞–Ω–∫–∏ –Ω–∞ –ø—Ä—è–º—ã—Ö —Ä—É–∫–∞—Ö. –ë—ã—Å—Ç—Ä–æ –ø–æ–¥—Ç—è–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–µ –∫–æ–ª–µ–Ω–æ –∫ –ª–µ–≤–æ–º—É –ª–æ–∫—Ç—é, —Å–∫—Ä—É—á–∏–≤–∞—è –∫–æ—Ä–ø—É—Å. –í–µ—Ä–Ω–∏—Ç–µ –Ω–æ–≥—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ —Å—Ä–∞–∑—É –ø–æ–¥—Ç—è–Ω–∏—Ç–µ –ª–µ–≤–æ–µ –∫–æ–ª–µ–Ω–æ –∫ –ø—Ä–∞–≤–æ–º—É –ª–æ–∫—Ç—é. –î–µ—Ä–∂–∏—Ç–µ –ø—Ä–µ—Å—Å –≤ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏, –Ω–µ –ø–æ–¥–Ω–∏–º–∞–π—Ç–µ —Ç–∞–∑ –≤—ã—Å–æ–∫–æ."
            },
            {
                name: "–í—ã–ø–∞–¥—ã —Å –º–µ—Å—Ç–∞",
                technique: "–í—Å—Ç–∞–Ω—å—Ç–µ –ø—Ä—è–º–æ, –Ω–æ–≥–∏ –Ω–∞ —à–∏—Ä–∏–Ω–µ –ø–ª–µ—á. –°–¥–µ–ª–∞–π—Ç–µ —à–∏—Ä–æ–∫–∏–π —à–∞–≥ –≤–ø–µ—Ä—ë–¥ –ø—Ä–∞–≤–æ–π –Ω–æ–≥–æ–π. –û–ø—É—Å—Ç–∏—Ç–µ—Å—å –≤ –≤—ã–ø–∞–¥ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–±–∞ –∫–æ–ª–µ–Ω–∞ –±—ã–ª–∏ —Å–æ–≥–Ω—É—Ç—ã –ø–æ–¥ —É–≥–ª–æ–º 90¬∞. –ö–æ–ª–µ–Ω–æ –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–∏ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –Ω–æ—Å–æ–∫, –∫–æ–ª–µ–Ω–æ –∑–∞–¥–Ω–µ–π –ø–æ—á—Ç–∏ –∫–∞—Å–∞–µ—Ç—Å—è –ø–æ–ª–∞. –û—Ç—Ç–æ–ª–∫–Ω–∏—Ç–µ—Å—å –ø–µ—Ä–µ–¥–Ω–µ–π –Ω–æ–≥–æ–π –∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ."
            },
            {
                name: "–†—É–∫–æ—Ö–æ–¥ –≤ –ø–ª–∞–Ω–∫–µ",
                technique: "–ü—Ä–∏–º–∏—Ç–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–ª–∞–Ω–∫–∏ –Ω–∞ –ø—Ä—è–º—ã—Ö —Ä—É–∫–∞—Ö. –û–ø—É—Å—Ç–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–µ–¥–ø–ª–µ—á—å–µ –æ–¥–Ω–æ–π —Ä—É–∫–∏, –∑–∞—Ç–µ–º –¥—Ä—É–≥–æ–π. –¢–µ–ø–µ—Ä—å –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ø–ª–∞–Ω–∫—É –Ω–∞ —Ä—É–∫–∞—Ö, –ø–æ–¥–Ω–∏–º–∞—è—Å—å –Ω–∞ –ª–∞–¥–æ–Ω—å —Å–Ω–∞—á–∞–ª–∞ –æ–¥–Ω–æ–π, –∑–∞—Ç–µ–º –¥—Ä—É–≥–æ–π —Ä—É–∫–∏. –î–µ—Ä–∂–∏—Ç–µ —Ç–µ–ª–æ –ø—Ä—è–º–æ, –Ω–µ –¥–æ–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–æ–≤–∏—Å–∞–Ω–∏—è –∏–ª–∏ –≤—ã–ø—è—á–∏–≤–∞–Ω–∏—è —Ç–∞–∑–∞."
            }
        ];

        const defaultWorkoutConfig = {
            workTime: 45,
            restTime: 15,
            circleRestTime: 60,
            countdownTime: 5,
            name: "–ë–∞–∑–æ–≤—ã–π –∂–∏—Ä–æ—Å–∂–∏–≥–∞—é—â–∏–π –∫–æ–º–ø–ª–µ–∫—Å"
        };

        // ================= –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =================
        let exercises = JSON.parse(JSON.stringify(defaultExercises));
        let workoutConfig = { ...defaultWorkoutConfig };
        let currentTime = workoutConfig.workTime;
        let isRunning = false, isPaused = false;
        let currentPhase = 'work';
        let currentExerciseIndex = 0, currentCircle = 1, totalCircles = 5;
        let timerInterval = null, countdownActive = false, speechVolume = 1;
        let isFullscreen = false, wakeLock = null, mouseKeepAliveInterval = null;
        let speakTechnique = true;

        // ================= –≠–õ–ï–ú–ï–ù–¢–´ DOM =================
        const timerElement = document.getElementById('timer');
        const exerciseNameElement = document.getElementById('exerciseName');
        const phaseElement = document.getElementById('phase');
        const circleInfoElement = document.getElementById('circleInfo');
        const statusElement = document.getElementById('status');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const circlesSelect = document.getElementById('circles');
        const exercisesListElement = document.getElementById('exercisesList');
        const volumeSlider = document.getElementById('volume');
        const volumeValue = document.getElementById('volumeValue');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const keepAliveInfo = document.getElementById('keepAliveInfo');
        const nextExerciseElement = document.getElementById('nextExercise');
        const nextExerciseNameElement = document.getElementById('nextExerciseName');
        const techniqueElement = document.getElementById('technique');
        const hintToggleBtn = document.getElementById('hintToggle');
        
        // –ù–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        const loadConfigBtn = document.getElementById('loadConfigBtn');
        const configFileInput = document.getElementById('configFileInput');
        const downloadConfigBtn = document.getElementById('downloadConfigBtn');
        const saveConfigBtn = document.getElementById('saveConfigBtn');
        const resetConfigBtn = document.getElementById('resetConfigBtn');
        const currentConfigInfo = document.getElementById('currentConfigInfo');

        // ================= –§–£–ù–ö–¶–ò–ò –†–ê–ë–û–¢–´ –° –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ï–ô =================
        function loadConfiguration(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const configData = JSON.parse(e.target.result);
                    
                    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
                    if (!configData.exercises || !Array.isArray(configData.exercises)) {
                        throw new Error("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–∞—Å—Å–∏–≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π");
                    }
                    
                    if (configData.exercises.length === 0) {
                        throw new Error("–ú–∞—Å—Å–∏–≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º");
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
                    configData.exercises.forEach((ex, index) => {
                        if (!ex.name || !ex.technique) {
                            throw new Error(`–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ${index + 1} –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å name –∏ technique`);
                        }
                    });
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
                    exercises = configData.exercises;
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–π–º–µ—Ä–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
                    if (configData.workoutConfig) {
                        workoutConfig = {
                            workTime: configData.workoutConfig.workTime || defaultWorkoutConfig.workTime,
                            restTime: configData.workoutConfig.restTime || defaultWorkoutConfig.restTime,
                            circleRestTime: configData.workoutConfig.circleRestTime || defaultWorkoutConfig.circleRestTime,
                            countdownTime: configData.workoutConfig.countdownTime || defaultWorkoutConfig.countdownTime,
                            name: configData.workoutConfig.name || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–º–ø–ª–µ–∫—Å"
                        };
                    }
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä—É–≥–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)
                    if (configData.totalCircles) {
                        totalCircles = configData.totalCircles;
                        circlesSelect.value = totalCircles.toString();
                    }
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                    resetWorkout();
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    updateExerciseList();
                    updateDisplay();
                    updateConfigInfo(configData.workoutConfig?.name || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–º–ø–ª–µ–∫—Å");
                    
                    speak(`–ó–∞–≥—Ä—É–∂–µ–Ω –∫–æ–º–ø–ª–µ–∫—Å: ${exercises.length} —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π`);
                    
                } catch (error) {
                    speak("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏");
                    statusElement.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                    statusElement.style.color = '#ff6b6b';
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:", error);
                }
            };
            
            reader.onerror = function() {
                speak("–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞");
                statusElement.textContent = "–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞";
                statusElement.style.color = '#ff6b6b';
            };
            
            reader.readAsText(file);
        }

        function downloadCurrentConfiguration() {
            const configToSave = {
                version: "1.0",
                exportedAt: new Date().toISOString(),
                exercises: exercises,
                workoutConfig: workoutConfig,
                totalCircles: totalCircles
            };
            
            const dataStr = JSON.stringify(configToSave, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `workout-config-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            speak("–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞");
            statusElement.textContent = "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∫–∞—á–∞–Ω–∞";
            statusElement.style.color = '#4ecdc4';
            setTimeout(() => {
                if (!isRunning) statusElement.textContent = "–ì–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏";
            }, 2000);
        }

        function saveAsDefaultConfiguration() {
            try {
                const configToSave = {
                    exercises: exercises,
                    workoutConfig: workoutConfig
                };
                
                localStorage.setItem('customWorkoutConfig', JSON.stringify(configToSave));
                
                speak("–ö–æ–º–ø–ª–µ–∫—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π");
                statusElement.textContent = "–ö–æ–º–ø–ª–µ–∫—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π";
                statusElement.style.color = '#4ecdc4';
                updateConfigInfo(workoutConfig.name || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π (—Å–æ—Ö—Ä–∞–Ω—ë–Ω)");
                
                setTimeout(() => {
                    if (!isRunning) statusElement.textContent = "–ì–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏";
                }, 2000);
                
            } catch (error) {
                speak("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è");
                statusElement.textContent = "–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏";
                statusElement.style.color = '#ff6b6b';
            }
        }

        function loadDefaultConfiguration() {
            try {
                const savedConfig = localStorage.getItem('customWorkoutConfig');
                
                if (savedConfig) {
                    const configData = JSON.parse(savedConfig);
                    exercises = configData.exercises || defaultExercises;
                    workoutConfig = configData.workoutConfig || defaultWorkoutConfig;
                    
                    resetWorkout();
                    updateExerciseList();
                    updateDisplay();
                    updateConfigInfo(workoutConfig.name || "–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å");
                    
                    speak("–ó–∞–≥—Ä—É–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å");
                } else {
                    resetToBaseConfiguration();
                }
                
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:", error);
                resetToBaseConfiguration();
            }
        }

        function resetToBaseConfiguration() {
            exercises = JSON.parse(JSON.stringify(defaultExercises));
            workoutConfig = { ...defaultWorkoutConfig };
            totalCircles = 5;
            circlesSelect.value = "5";
            
            resetWorkout();
            updateExerciseList();
            updateDisplay();
            updateConfigInfo("–ë–∞–∑–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å");
            
            speak("–ó–∞–≥—Ä—É–∂–µ–Ω –±–∞–∑–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å");
            statusElement.textContent = "–ó–∞–≥—Ä—É–∂–µ–Ω –±–∞–∑–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π";
            statusElement.style.color = '#4ecdc4';
            
            setTimeout(() => {
                if (!isRunning) statusElement.textContent = "–ì–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏";
            }, 2000);
        }

        function updateConfigInfo(configName) {
            currentConfigInfo.textContent = `–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: ${configName} (${exercises.length} —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π)`;
        }

        // ================= –ú–û–î–ò–§–ò–¶–ò–†–û–í–ê–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò =================
        function init() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è —Ç–µ—Ö–Ω–∏–∫–∏
            const savedSetting = localStorage.getItem('speakTechnique');
            if (savedSetting !== null) {
                speakTechnique = savedSetting === 'true';
            }
            hintToggleBtn.textContent = speakTechnique ? 
                "–û–∑–≤—É—á–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É ‚úì" : "–û–∑–≤—É—á–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É";
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–ª–∏ –±–∞–∑–æ–≤—É—é
            loadDefaultConfiguration();
            
            totalCircles = parseInt(circlesSelect.value);
            updateExerciseList();
            updateDisplay();
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            startBtn.addEventListener('click', startWorkout);
            pauseBtn.addEventListener('click', togglePause);
            resetBtn.addEventListener('click', resetWorkout);
            hintToggleBtn.addEventListener('click', toggleTechniqueVoice);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            loadConfigBtn.addEventListener('click', () => {
                configFileInput.click();
            });
            
            configFileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    loadConfiguration(e.target.files[0]);
                    e.target.value = ''; // –°–±—Ä–æ—Å –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
                }
            });
            
            downloadConfigBtn.addEventListener('click', downloadCurrentConfiguration);
            saveConfigBtn.addEventListener('click', saveAsDefaultConfiguration);
            resetConfigBtn.addEventListener('click', resetToBaseConfiguration);
            
            circlesSelect.addEventListener('change', () => {
                totalCircles = parseInt(circlesSelect.value);
                updateCircleInfo();
            });
            
            volumeSlider.addEventListener('input', (e) => {
                speechVolume = parseFloat(e.target.value);
                volumeValue.textContent = `${Math.round(speechVolume * 100)}%`;
            });
            
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            
            const fullscreenEvents = ['fullscreenchange', 'webkitfullscreenchange', 
                                     'mozfullscreenchange', 'MSFullscreenChange'];
            fullscreenEvents.forEach(event => {
                document.addEventListener(event, updateFullscreenButton);
            });
            
            if (!('speechSynthesis' in window)) {
                statusElement.textContent = '–í–Ω–∏–º–∞–Ω–∏–µ: –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è';
                statusElement.style.color = '#ff6b6b';
            }
        }

        // ================= –ü–†–ò–ú–ï–† –§–û–†–ú–ê–¢–ê JSON-–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò =================
        // –î–ª—è —Å–ø—Ä–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function showExampleConfig() {
            const exampleConfig = {
                "version": "1.0",
                "name": "–ú–æ–π –∫–æ–º–ø–ª–µ–∫—Å",
                "exercises": [
                    {
                        "name": "–ü—Ä—ã–∂–∫–∏ —á–µ—Ä–µ–∑ —Å–∫–∞–∫–∞–ª–∫—É",
                        "technique": "–ü—Ä—ã–≥–∞–π—Ç–µ –Ω–∞ –Ω–æ—Å–∫–∞—Ö, –≤—Ä–∞—â–∞—è —Å–∫–∞–∫–∞–ª–∫—É –∫–∏—Å—Ç—è–º–∏, –∞ –Ω–µ –≤—Å–µ–π —Ä—É–∫–æ–π."
                    },
                    {
                        "name": "–ü–ª–∞–Ω–∫–∞",
                        "technique": "–õ–æ–∫—Ç–∏ –ø–æ–¥ –ø–ª–µ—á–∞–º–∏, —Ç–µ–ª–æ –æ–±—Ä–∞–∑—É–µ—Ç –ø—Ä—è–º—É—é –ª–∏–Ω–∏—é, –ø—Ä–µ—Å—Å –Ω–∞–ø—Ä—è–∂—ë–Ω."
                    }
                ],
                "workoutConfig": {
                    "workTime": 40,
                    "restTime": 20,
                    "circleRestTime": 45,
                    "countdownTime": 3,
                    "name": "–ö–∞—Ä–¥–∏–æ –∫–æ–º–ø–ª–µ–∫—Å"
                },
                "totalCircles": 4
            };
            
            console.log("–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:", JSON.stringify(exampleConfig, null, 2));
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (startWorkout, togglePause, resetWorkout, updateTimer, 
        // handleTimerComplete, completeWorkout, updateExerciseDetails, toggleTechniqueVoice,
        // speakExerciseWithTechnique, updateExerciseList, updateActiveExercise, updateDisplay,
        // getPhaseText, updateCircleInfo, speak, speakCountdown, toggleFullscreen,
        // enterFullscreen, exitFullscreen, updateFullscreenButton, requestWakeLock,
        // releaseKeepAlive, startMouseMoveKeepAlive, stopMouseMoveKeepAlive)
        // –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞
        
        // ================= –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =================
        function updateExerciseDetails() {
            if (exercises.length === 0) return;
            
            exerciseNameElement.textContent = exercises[currentExerciseIndex].name;
            techniqueElement.textContent = exercises[currentExerciseIndex].technique;
            
            let nextIndex = currentExerciseIndex + 1;
            let nextCircle = currentCircle;
            
            if (nextIndex >= exercises.length) {
                nextIndex = 0;
                nextCircle = currentCircle + 1;
            }
            
            if (nextCircle <= totalCircles) {
                nextExerciseNameElement.textContent = exercises[nextIndex].name;
            } else {
                nextExerciseNameElement.textContent = "–ö–æ–Ω–µ—Ü —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏";
            }
            
            if (currentPhase === 'rest' || currentPhase === 'circleRest') {
                nextExerciseElement.classList.add('show');
            } else {
                nextExerciseElement.classList.remove('show');
            }
            
            updateActiveExercise();
        }
        
        function toggleTechniqueVoice() {
            speakTechnique = !speakTechnique;
            hintToggleBtn.textContent = speakTechnique ? 
                "–û–∑–≤—É—á–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É ‚úì" : "–û–∑–≤—É—á–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É";
            localStorage.setItem('speakTechnique', speakTechnique);
        }
        
        function speakExerciseWithTechnique() {
            if (exercises.length === 0) return;
            
            const exercise = exercises[currentExerciseIndex];
            let textToSpeak = `–ù–∞—á–∏–Ω–∞–µ–º ${exercise.name}`;
            
            if (speakTechnique) {
                textToSpeak += `. ${exercise.technique}`;
            }
            
            speak(textToSpeak);
        }

        // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–π (startWorkout, togglePause, resetWorkout, updateTimer,
        // handleTimerComplete, completeWorkout, updateExerciseList, updateActiveExercise,
        // updateDisplay, getPhaseText, updateCircleInfo, speak, speakCountdown,
        // toggleFullscreen, enterFullscreen, exitFullscreen, updateFullscreenButton,
        // requestWakeLock, releaseKeepAlive, startMouseMoveKeepAlive, stopMouseMoveKeepAlive)
        // –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ

        // ================= –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô =================
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isFullscreen) setTimeout(updateFullscreenButton, 100);
            
            if (e.code === 'Space') {
                e.preventDefault();
                if (isRunning) togglePause(); else startWorkout();
            }
            
            if (e.code === 'KeyR' && e.ctrlKey) {
                e.preventDefault();
                resetWorkout();
            }
            
            if (e.code === 'KeyF') {
                e.preventDefault();
                toggleFullscreen();
            }
            
            if (e.code === 'KeyH' && e.ctrlKey) {
                e.preventDefault();
                toggleTechniqueVoice();
            }
            
            // –ù–æ–≤–∞—è –≥–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞: Ctrl+O –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            if (e.code === 'KeyO' && e.ctrlKey) {
                e.preventDefault();
                configFileInput.click();
            }
        });

        document.addEventListener('visibilitychange', async () => {
            if (document.visibilityState === 'visible' && isRunning && !isPaused) {
                try {
                    await requestWakeLock();
                } catch (err) {
                    console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —ç–∫—Ä–∞–Ω–∞:', err);
                }
            }
        });

        // ================= –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =================
        window.addEventListener('DOMContentLoaded', init);
        
        speechSynthesis.getVoices();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = () => {};
        }
        
        window.addEventListener('beforeunload', () => {
            if (wakeLock !== null) wakeLock.release();
            if (mouseKeepAliveInterval) clearInterval(mouseKeepAliveInterval);
        });
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ (–≤ –∫–æ–Ω—Å–æ–ª–∏)
        window.addEventListener('load', () => {
            console.log("–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–µ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ JSON —Ñ–æ—Ä–º–∞—Ç. –í—ã–∑–æ–≤–∏—Ç–µ showExampleConfig() –≤ –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞.");
        });
    </script>
</body>
</html>
